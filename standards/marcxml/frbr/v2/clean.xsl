<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:marc="http://lcnetdev.github.io/MARC21/slim" xmlns="http://lcnetdev.github.io/MARC21/frbr" xmlns:mods="http://lcnetdev.github.io/mods/" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" exclude-result-prefixes="marc">
	<xsl:include href="MARC21slimUtils.xsl"/>
	<xsl:output media-type="xml" indent="yes"/>

	<xsl:template match="node()|@*" priority="-1">
		<!-- Copy the current node -->
		<xsl:copy>
			<!-- Including any attributes it has and any child nodes -->
			<xsl:apply-templates select="@*|node()"/>
		</xsl:copy>
	</xsl:template>

	<xsl:template match="marc:subfield[position() = last()]/text()" priority="0">
		<xsl:call-template name="dropFromOldCatalog"/>
	</xsl:template>

	<xsl:template match="marc:datafield[@tag &gt;= 100 and @tag &lt; 200]/marc:subfield[@code='d']/text()" priority="1">
		<xsl:choose>
			<xsl:when test="contains(.,'-')">
				<xsl:value-of select="substring-before(.,'-')"/>
			</xsl:when>
			<xsl:otherwise><xsl:value-of select="."/></xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="chopIfLast">
		<xsl:choose>
			<xsl:when test="position() = last()">
				<xsl:call-template name="chopPunctuation">
					<xsl:with-param name="chopString" select="."/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="."/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="dropFromOldCatalog">
		<xsl:param name="str"><xsl:value-of select="."/></xsl:param>
		<xsl:choose>
			<xsl:when test="contains($str,'[from old catalog]')">
				<xsl:value-of select="substring-before($str,'[from old catalog]')"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$str"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
</xsl:stylesheet><!-- Stylus Studio meta-information - (c)1998-2003 Copyright Sonic Software Corporation. All rights reserved.
<metaInformation>
<scenarios ><scenario default="yes" name="All Welty" userelativepaths="yes" externalpreview="no" url="eudorawelty.xml" htmlbaseurl="" outputurl="" processortype="internal" commandline="" additionalpath="" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jackie" userelativepaths="yes" externalpreview="no" url="..\..\..\CVSprojects\marc4j\dist\lib\matching.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jane Eyre" userelativepaths="yes" externalpreview="no" url="janeeyre.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jackie Jane Eyre" userelativepaths="yes" externalpreview="no" url="jackiejaneeyre.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jane Eyre 7.4" userelativepaths="yes" externalpreview="no" url="janeeyre.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;4\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Music" userelativepaths="yes" externalpreview="no" url="..\..\..\CVSprojects\marcxml\dist\lib\music.xml" htmlbaseurl="" outputurl="musicfrbr.xml" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Franz" userelativepaths="yes" externalpreview="no" url="franz.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="LITA" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\lita.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="LC" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\lc.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Scenario1" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\wpc.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="ATT" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\att.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Catholic" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\catholic.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="All Welty" userelativepaths="yes" externalpreview="no" url="eudorawelty.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jackie" userelativepaths="yes" externalpreview="no" url="..\..\..\CVSprojects\marc4j\dist\lib\matching.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jane Eyre" userelativepaths="yes" externalpreview="no" url="janeeyre.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jackie Jane Eyre" userelativepaths="yes" externalpreview="no" url="jackiejaneeyre.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Jane Eyre 7.4" userelativepaths="yes" externalpreview="no" url="janeeyre.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;4\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Music" userelativepaths="yes" externalpreview="no" url="..\..\..\CVSprojects\marcxml\dist\lib\music.xml" htmlbaseurl="" outputurl="musicfrbr.xml" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Franz" userelativepaths="yes" externalpreview="no" url="franz.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="LITA" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\lita.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="LC" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\lc.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Scenario1" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\wpc.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="ATT" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\att.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/><scenario default="no" name="Catholic" userelativepaths="yes" externalpreview="no" url="..\..\..\marcxml\catholic.xml" htmlbaseurl="" outputurl="" processortype="custom" commandline="java  &#x2D;jar C:\saxon7&#x2D;1\saxon7.jar &#x2D;o %3 %1 %2" additionalpath="c:\j2sdk1.4.1\bin" additionalclasspath="" postprocessortype="none" postprocesscommandline="" postprocessadditionalpath="" postprocessgeneratedext=""/></scenarios><MapperInfo srcSchemaPath="" srcSchemaRoot="" srcSchemaPathIsRelative="yes" srcSchemaInterpretAsXML="no" destSchemaPath="" destSchemaRoot="" destSchemaPathIsRelative="yes" destSchemaInterpretAsXML="no"/>
</metaInformation>
-->